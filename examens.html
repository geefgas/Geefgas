<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GeefGas – Taxi examens</title>

  <link rel="stylesheet" href="styles.css">

  <!-- Laad beide datasets -->
  <script src="exam-data.js"></script>
  <script src="exam-data-hard.js"></script>

  <style>
    /* Klein, netjes difficulty blok (werkt ook zonder styles.css aan te passen) */
    .difficultyBar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin:14px 0 10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
    }
    .difficultyBadge{
      font-weight:700;
      font-size:14px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .difficultyBadge--easy{ border-color: rgba(43,124,255,.55); }
    .difficultyBadge--hard{ border-color: rgba(255,59,87,.55); }

    .difficultyBtn{
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06);
      color:inherit;
      border-radius:12px;
      padding:10px 12px;
      font-weight:700;
      cursor:pointer;
    }
  </style>
</head>

<body class="theme">

<!-- HEADER -->
<header class="topbar">
  <div class="container topbar__inner">
    <a class="brand" href="index.html" aria-label="GeefGas Home">
      <img class="brand__logo" src="assets/geefgas.PNG" alt="GeefGas logo">
      <span class="brand__name">GeefGas</span>
    </a>

    <nav class="nav" aria-label="Hoofdmenu">
      <a class="nav__link" href="index.html">Home</a>
      <a class="nav__link" href="instellingen.html">Instellingen</a>
    </nav>
  </div>
</header>

<!-- PAGINA -->
<main class="page">
  <div class="container page__inner">

    <!-- HERO AFBEELDING -->
    <section class="exam-hero-image" aria-label="Taxi examens banner">
      <img
        src="assets/taxi-examens.PNG"
        alt="Taxi examens – GeefGas"
        loading="eager"
      >
    </section>

    <!-- DIFFICULTY BAR -->
    <div class="difficultyBar" aria-label="Niveau selectie">
      <div id="difficultyBadge" class="difficultyBadge">Niveau: …</div>
      <button id="changeDifficulty" class="difficultyBtn" type="button">Wijzig niveau</button>
    </div>

    <!-- BADGE -->
    <div class="exam-count-wrapper" aria-label="Aantal examens">
      <div class="exam-count" id="examCount">— examens</div>
    </div>

    <!-- EXAMENS -->
    <section aria-label="Examenlijst">
      <div id="examList"></div>
    </section>

  </div>
</main>

<!-- SCRIPT -->
<script>
(function () {
  // 1) Difficulty check
  const difficulty = localStorage.getItem("ggDifficulty");
  if (!difficulty) {
    // Als nog niet gekozen -> stuur naar difficulty pagina
    window.location.href = "difficulty.html";
    return;
  }

  const isHard = difficulty === "hard";

  // 2) Badge + knop
  const badgeEl = document.getElementById("difficultyBadge");
  badgeEl.textContent = "Niveau: " + (isHard ? "Moeilijk (strikvragen)" : "Makkelijk");
  badgeEl.classList.add(isHard ? "difficultyBadge--hard" : "difficultyBadge--easy");

  document.getElementById("changeDifficulty").addEventListener("click", () => {
    window.location.href = "difficulty.html";
  });

  // 3) Pak juiste dataset
  const easyData = window.EXAM_DATA;
  const hardData = window.EXAM_DATA_HARD;

  const easyAll = (easyData && Array.isArray(easyData.exams)) ? easyData.exams : [];
  const hardAll = (hardData && Array.isArray(hardData.exams)) ? hardData.exams : [];

  const all = isHard ? hardAll : easyAll;

  const listEl = document.getElementById("examList");
  const countEl = document.getElementById("examCount");

  // 4) Guard: data ontbreekt
  if (!all.length) {
    listEl.innerHTML = isHard
      ? "<p class='muted'><strong>Moeilijk niveau is nog leeg of niet goed geladen.</strong><br>Controleer of <strong>exam-data-hard.js</strong> bestaat en <code>window.EXAM_DATA_HARD</code> zet.</p>"
      : "<p class='muted'>Examendata niet gevonden. Controleer of <strong>exam-data.js</strong> goed geladen wordt.</p>";
    countEl.textContent = "0 examens";
    return;
  }

  // 5) Alleen Taxi
  const exams = all.filter(e => String(e.category).toLowerCase() === "taxi");

  countEl.textContent = `${exams.length} examens`;

  if (!exams.length) {
    listEl.innerHTML = "<p class='muted'>Geen taxi examens gevonden.</p>";
    return;
  }

  // 6) Sort op nummer in id (taxi-examen-1, taxi-examen-2, etc.)
  exams.sort((a,b) => {
    const an = Number(String(a.id).match(/\\d+/)?.[0] || 9999);
    const bn = Number(String(b.id).match(/\\d+/)?.[0] || 9999);
    return an - bn;
  });

  // 7) Render cards
  listEl.innerHTML = "";
  exams.forEach(exam => {
    const card = document.createElement("div");
    card.className = "examItem";

    const qCount = Array.isArray(exam.questions) ? exam.questions.length : 0;
    const mins = Number(exam.durationMinutes || 30);

    card.innerHTML = `
      <div class="examItem__head">
        <div>
          <div class="examItem__title">${exam.title || "Examen"}</div>
          <div class="examItem__meta">
            ${qCount} vragen • ${mins} min
          </div>
        </div>
      </div>

      <button class="examItem__start" type="button" aria-label="Start ${exam.title || "examen"}">
        Start
      </button>
    `;

    card.querySelector("button").addEventListener("click", () => {
      localStorage.setItem("gg_examId", exam.id);
      window.location.href = "examen.html";
    });

    listEl.appendChild(card);
  });
})();
</script>

</body>
</html>
